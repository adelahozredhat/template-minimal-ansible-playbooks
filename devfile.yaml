# cspell: disable=devspaces
schemaVersion: 2.2.2
metadata:
  name: ansible-demo
components:
  - name: tooling-container
    container:
      image: ghcr.io/ansible/ansible-devspaces@sha256:f833103c12adf6ecb3cc8245dbc2d852ec5025c8c487d601b96995ea8783fb2f
      memoryRequest: 256M
      memoryLimit: 4Gi
      cpuRequest: 250m
      cpuLimit: 1000m
      args: ['tail', '-f', '/dev/null']
      env:
        - name: 'ANSIBLE_COLLECTIONS_PATH'
          value: '~/.ansible/collections:/usr/share/ansible/collections:/projects/ansible-devspaces-demo/collections'

commands:

  - id: yamlint
    exec:
      label: "yamlint"
      commandLine: 'yamllint . --no-warnings -d "{extends: default, rules: {line-length: {max: 150}}}"'
      workingDir: ${PROJECTS_ROOT}
      group:
        kind: run
        isDefault: true
      component: tooling-container

  - id: ansible-lint
    exec:
      label: "ansible-lint"
      commandLine: 'ansible-lint --nocolor'
      workingDir: ${PROJECTS_ROOT}
      group:
        kind: run
        isDefault: true
      component: tooling-container

  - id: molecule
    exec:
      label: "ansible-lint"
      commandLine: 'ansible-lint --nocolor'
      workingDir: ${PROJECTS_ROOT}
      group:
        kind: run
        isDefault: true
      component: tooling-container

